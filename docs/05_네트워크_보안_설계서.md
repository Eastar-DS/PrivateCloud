# 네트워크/보안 설계서

## 지자체 공동활용 AI 플랫폼 인프라 구축 프로젝트
### 공공 데이터 주권 확보를 위한 멀티테넌트 프라이빗 클라우드 설계

| 항목 | 내용 |
|------|------|
| 문서명 | 네트워크/보안 설계서 |
| 버전 | 3.0 |
| 작성일 | 2026-01-30 |
| 담당팀 | 네트워크/보안 팀 |

---

**목차**

1. [설계 개요 및 목표](#1-설계-개요-및-목표)
2. [망분리 설계](#2-망분리-설계)
3. [마이크로세그멘테이션](#3-마이크로세그멘테이션)
4. [방화벽 정책](#4-방화벽-정책)
5. [로드밸런서 설계](#5-로드밸런서-설계)
6. [데이터 품질 게이트 설계](#6-데이터-품질-게이트-설계)
7. [Zero Trust 아키텍처](#7-zero-trust-아키텍처)
8. [암호화 체계](#8-암호화-체계)
9. [감사 및 로깅](#9-감사-및-로깅)

---

## 1. 설계 개요 및 목표

### 1.1 설계 목표

| 목표 | 설명 | 검증 방법 |
|------|------|----------|
| **망분리** | 9개 네트워크 존 분리 (테넌트/공용서비스/AI/관리) | VLAN 구성 확인 |
| **테넌트 격리** | 테넌트 간 네트워크 통신 차단 | 격리 테스트 |
| **AI 플랫폼 격리** | AI 내부망과 서비스망 분리 | 계층간 접근 제어 확인 |
| **데이터 품질 게이트** | 테넌트→AI 플랫폼 데이터 흐름 제어 | 게이트 정책 테스트 |
| **접근 제어** | RBAC 기반 권한 관리 | 권한 테스트 |
| **암호화** | 전송/저장 데이터 암호화 | 암호화 적용 확인 |

### 1.2 설계 범위

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     네트워크/보안 설계 범위                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   In-Scope (담당 영역)                                                      │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  - 망분리 설계 (VLAN, 네트워크 존)                                   │  │
│   │  - AI 플랫폼 네트워크 (내부망/서비스망/스토리지망)                   │  │
│   │  - 데이터 품질 게이트 설계                                           │  │
│   │  - 마이크로세그멘테이션 (테넌트 간 격리)                             │  │
│   │  - 방화벽 정책 (Security Group)                                     │  │
│   │  - 로드밸런서 설계                                                   │  │
│   │  - RBAC 설계 및 구현                                                 │  │
│   │  - 암호화 체계 (TLS, 저장 데이터)                                    │  │
│   │  - 감사 로깅                                                         │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   협업 영역 (다른 팀과 공동)                                                │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  - VM 네트워크 연결 (컴퓨트/개발 팀)                                 │  │
│   │  - GPU 호스트 네트워크 (컴퓨트/개발 팀)                              │  │
│   │  - 스토리지 네트워크 (스토리지 팀)                                   │  │
│   │  - AI 스토리지 네트워크 (스토리지 팀)                                │  │
│   │  - 모니터링 네트워크 (공통)                                          │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 망분리 설계

### 2.1 네트워크 존 정의

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        네트워크 존 구조 (9개 VLAN)                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [인터넷]                                                                  │
│       │                                                                     │
│       ▼                                                                     │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  DMZ (VLAN 10)                                                      │  │
│   │  - 외부 접근 허용 구간                                               │  │
│   │  - 로드밸런서, 리버스 프록시, API Gateway                            │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│       │                                                                     │
│       ▼                                                                     │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  테넌트 데이터 영역 (VLAN 20, 21, 22)                               │  │
│   │  ┌───────────┐  ┌───────────┐  ┌───────────┐                       │  │
│   │  │ 테넌트 A  │  │ 테넌트 B  │  │ 테넌트 C  │                       │  │
│   │  │ 수원시    │  │ 성남시    │  │ 용인시    │                       │  │
│   │  │ 데이터    │  │ 데이터    │  │ (API만)   │                       │  │
│   │  │ 업로드VM  │  │ 업로드VM  │  │           │                       │  │
│   │  │ VLAN 20   │  │ VLAN 21   │  │ VLAN 22   │                       │  │
│   │  └───────────┘  └───────────┘  └───────────┘                       │  │
│   │      ↕ 테넌트 간 통신 차단 (마이크로세그멘테이션)                    │  │
│   │  ※ 테넌트 웹/앱/DB 서버 없음 (AI 플랫폼 인프라만 구축)             │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│       │                                                                     │
│       ▼                                                                     │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  공용 DB망 (VLAN 30)                                                │  │
│   │  - 공용 데이터베이스 서버                                            │  │
│   │  - 테넌트별 스키마/DB 분리                                           │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  공용 스토리지망 (VLAN 40)                                          │  │
│   │  - Ceph 클러스터 전용 네트워크                                       │  │
│   │  - 고대역폭, 저지연 (10Gbps+)                                        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  AI 플랫폼 네트워크 (VLAN 50, 55, 60)                               │  │
│   │  ┌─────────────────────────────────────────────────────────────┐    │  │
│   │  │  AI 내부망 (VLAN 50) - GPU 클러스터, 학습/추론 서버          │    │  │
│   │  │  AI 서비스망 (VLAN 55) - API Gateway, 서비스 Endpoint        │    │  │
│   │  │  AI 스토리지망 (VLAN 60) - 모델/데이터셋 전용 스토리지        │    │  │
│   │  └─────────────────────────────────────────────────────────────┘    │  │
│   │      ↕ 품질 게이트를 통한 데이터 흐름 제어                          │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  관리망 (VLAN 100)                                                  │  │
│   │  - SSH 접근 (Bastion 경유)                                          │  │
│   │  - 모니터링, 관리 콘솔                                               │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 VLAN 할당 계획

| VLAN ID | 네트워크 존 | IP 대역 | 용도 | MTU |
|---------|-----------|---------|------|-----|
| **10** | DMZ | 10.0.1.0/24 | 외부 접근, 로드밸런서, API Gateway | 1500 |
| **20** | 테넌트 A | 10.0.20.0/24 | 수원시 데이터 영역 (업로드, API 접근) | 1500 |
| **21** | 테넌트 B | 10.0.21.0/24 | 성남시 데이터 영역 (업로드, API 접근) | 1500 |
| **22** | 테넌트 C | 10.0.22.0/24 | 용인시 데이터 영역 (API 접근만) | 1500 |
| **30** | 공용 DB망 | 10.0.30.0/24 | 공용 데이터베이스 | 1500 |
| **40** | 공용 스토리지망 | 10.0.40.0/24 | Ceph 클러스터 | 9000 |
| **50** | AI 내부망 | 10.0.50.0/24 | GPU 클러스터, 학습/추론 | 9000 |
| **55** | AI 서비스망 | 10.0.55.0/24 | AI API Endpoint | 1500 |
| **60** | AI 스토리지망 | 10.0.60.0/24 | 모델/데이터셋 스토리지 | 9000 |
| **100** | 관리망 | 10.0.100.0/24 | 관리, 모니터링 | 1500 |

**총 VLAN 사용: 10개** (가용 90개 중)

### 2.3 IP 대역 설계

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        IP 대역 할당 상세                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   10.0.1.0/24 (DMZ)                                                         │
│   ├── 10.0.1.1       : 게이트웨이                                           │
│   ├── 10.0.1.10-20   : 로드밸런서 VIP                                       │
│   ├── 10.0.1.30-40   : API Gateway                                          │
│   └── 10.0.1.100-110 : DMZ 서버                                             │
│                                                                             │
│   10.0.20.0/24 (테넌트 A - 수원시 데이터 영역)                              │
│   ├── 10.0.20.1      : 게이트웨이                                           │
│   ├── 10.0.20.10-20  : 데이터 업로드 VM (선택)                              │
│   └── 10.0.20.50-60  : API 접근용 (예비)                                    │
│   ※ 웹/앱/DB 서버 없음 (AI 서비스 이용자)                                  │
│                                                                             │
│   10.0.21.0/24 (테넌트 B - 성남시 데이터 영역)                              │
│   ├── 10.0.21.1      : 게이트웨이                                           │
│   ├── 10.0.21.10-20  : 데이터 업로드 VM (선택)                              │
│   └── 10.0.21.50-60  : API 접근용 (예비)                                    │
│   ※ 웹/앱/DB 서버 없음 (AI 서비스 이용자)                                  │
│                                                                             │
│   10.0.22.0/24 (테넌트 C - 용인시 데이터 영역)                              │
│   ├── 10.0.22.1      : 게이트웨이                                           │
│   └── 10.0.22.50-60  : API 접근용 (예비)                                    │
│   ※ VM 없음 (API 접근만)                                                   │
│                                                                             │
│   10.0.30.0/24 (공용 DB망)                                                  │
│   ├── 10.0.30.1      : 게이트웨이                                           │
│   ├── 10.0.30.10-20  : PostgreSQL 클러스터                                  │
│   ├── 10.0.30.30-40  : MySQL 클러스터                                       │
│   └── 10.0.30.50-60  : Redis 클러스터                                       │
│                                                                             │
│   10.0.40.0/24 (공용 스토리지망)                                            │
│   ├── 10.0.40.1      : 게이트웨이                                           │
│   ├── 10.0.40.10-30  : Ceph MON                                             │
│   ├── 10.0.40.40-60  : Ceph OSD (Hot Tier)                                  │
│   └── 10.0.40.70-100 : Ceph OSD (Warm/Cold Tier)                            │
│                                                                             │
│   10.0.50.0/24 (AI 내부망)                                                  │
│   ├── 10.0.50.1      : 게이트웨이                                           │
│   ├── 10.0.50.10-30  : GPU 호스트 (학습)                                    │
│   ├── 10.0.50.40-60  : GPU 호스트 (추론)                                    │
│   └── 10.0.50.100-120: AI 컨트롤러                                          │
│                                                                             │
│   10.0.55.0/24 (AI 서비스망)                                                │
│   ├── 10.0.55.1      : 게이트웨이                                           │
│   ├── 10.0.55.10-20  : AI API Gateway                                       │
│   ├── 10.0.55.30-40  : 모델 서빙 Endpoint                                   │
│   └── 10.0.55.50-60  : 데이터 품질 게이트                                   │
│                                                                             │
│   10.0.60.0/24 (AI 스토리지망)                                              │
│   ├── 10.0.60.1      : 게이트웨이                                           │
│   ├── 10.0.60.10-30  : 모델 레지스트리 스토리지                             │
│   ├── 10.0.60.40-60  : 데이터셋 스토리지                                    │
│   └── 10.0.60.70-90  : 체크포인트/아티팩트 스토리지                         │
│                                                                             │
│   10.0.100.0/24 (관리망)                                                    │
│   ├── 10.0.100.1     : 게이트웨이                                           │
│   ├── 10.0.100.10    : Bastion Host                                         │
│   ├── 10.0.100.20-30 : 모니터링 (Prometheus, Grafana)                       │
│   └── 10.0.100.50-80 : 관리 서버                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.4 네트워크 토폴로지

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        물리 네트워크 토폴로지                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                          [인터넷]                                            │
│                              │                                              │
│                              ▼                                              │
│                     ┌──────────────┐                                        │
│                     │   방화벽     │                                        │
│                     │  (L3/L4 FW)  │                                        │
│                     └──────┬───────┘                                        │
│                            │                                                │
│              ┌─────────────┼─────────────┐                                  │
│              ▼             ▼             ▼                                  │
│        ┌──────────┐  ┌──────────┐  ┌──────────┐                            │
│        │  Core    │  │  Core    │  │  Core    │   (이중화)                  │
│        │ Switch 1 │──│ Switch 2 │──│ Switch 3 │                            │
│        │ (Spine)  │  │ (Spine)  │  │ (Spine)  │                            │
│        └────┬─────┘  └────┬─────┘  └────┬─────┘                            │
│             │             │             │                                   │
│    ┌────────┴─────────────┴─────────────┴────────┐                         │
│    │                                              │                         │
│    ▼                    ▼                    ▼    │                         │
│  ┌──────────┐      ┌──────────┐      ┌──────────┐│                         │
│  │ Leaf SW  │      │ Leaf SW  │      │ Leaf SW  ││  (ToR)                  │
│  │ (Rack 1) │      │ (Rack 2) │      │ (Rack 3) ││                         │
│  └────┬─────┘      └────┬─────┘      └────┬─────┘│                         │
│       │                 │                 │      │                         │
│  ┌────┴────┐       ┌────┴────┐       ┌────┴────┐ │                         │
│  │ HCI     │       │ HCI     │       │ HCI     │ │                         │
│  │ Node 1-3│       │ Node 4-6│       │ Node 7-9│ │                         │
│  │ +GPU    │       │ +GPU    │       │ (일반)  │ │                         │
│  └─────────┘       └─────────┘       └─────────┘ │                         │
│                                                                             │
│   VLAN Trunk: 모든 VLAN (10,20,21,22,30,40,50,55,60,100)                   │
│   Bonding: LACP (4x10G → 40Gbps per node)                                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 마이크로세그멘테이션

### 3.1 세그멘테이션 원칙

> **기본 차단, 명시적 허용 (Default Deny, Explicit Allow)**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     마이크로세그멘테이션 개념                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   기존 방식 (Perimeter Security)                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                    내부 네트워크                                     │  │
│   │   [VM-A] ◄───────► [VM-B] ◄───────► [VM-C]                         │  │
│   │              ✓ 내부 통신 자유                                        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│   문제: 하나가 침해되면 전체 확산 가능                                      │
│                                                                             │
│   마이크로세그멘테이션 (Zero Trust)                                         │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │   ┌───────┐     ┌───────┐     ┌───────┐                            │  │
│   │   │ VM-A  │     │ VM-B  │     │ VM-C  │                            │  │
│   │   │ ───── │     │ ───── │     │ ───── │                            │  │
│   │   │정책 A │     │정책 B │     │정책 C │                            │  │
│   │   └───┬───┘     └───┬───┘     └───┬───┘                            │  │
│   │       │     ✗       │     ✗       │                                 │  │
│   │       └─────────────┴─────────────┘                                 │  │
│   │            허용된 통신만 가능                                        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│   효과: 침해 시 영향 범위 최소화                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 테넌트 간 격리

| 출발지 | 목적지 | 허용 여부 | 비고 |
|--------|--------|----------|------|
| 테넌트 A | 테넌트 B | **차단** | 기본 정책 |
| 테넌트 A | 테넌트 C | **차단** | 기본 정책 |
| 테넌트 B | 테넌트 C | **차단** | 기본 정책 |
| 테넌트 A | 공용 DB망 | **차단** | 직접 접근 불가 (AI API 경유) |
| 테넌트 A | AI 서비스망 | **허용** | 품질 게이트/API 경유 (443) |
| 테넌트 A | AI 내부망 | **차단** | 직접 접근 불가 |
| 테넌트 A | 관리망 | **차단** | Bastion 제외 |

### 3.3 AI 플랫폼 데이터 흐름 정책

```
┌─────────────────────────────────────────────────────────────────────────────┐
│               AI 플랫폼 4계층 데이터 흐름 정책                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [테넌트 데이터 영역] - 업무 시스템 없음, 데이터 제공자로만 참여           │
│                                                                             │
│   ┌─────────────┐                                                          │
│   │ 데이터      │                                                          │
│   │ 업로드 VM   │  ※ 테넌트 웹/앱/DB 없음                                  │
│   │ (선택)      │                                                          │
│   └──────┬──────┘                                                          │
│          │ 443 (데이터 업로드)                                              │
│          ▼                                                                  │
│   ┌─────────────┐                                                          │
│   │ 품질 게이트 │  - 데이터 검증, PII 마스킹                               │
│   │ (API GW)    │  - 테넌트 → AI 플랫폼 유일 경로                          │
│   └──────┬──────┘                                                          │
│          │ gRPC (50051)                                                     │
│          ▼                                                                  │
│   ┌─────────────┐                                                          │
│   │ AI 학습/    │  - 민원 분류 모델 학습                                   │
│   │ 추론 서버   │  - 추론 API 제공                                         │
│   │ (GPU)       │                                                          │
│   └──────┬──────┘                                                          │
│          │ 443 (추론 결과)                                                  │
│          ▼                                                                  │
│   ┌─────────────┐                                                          │
│   │ 테넌트      │  - API 호출로 결과 조회                                  │
│   │ (API 응답)  │                                                          │
│   └─────────────┘                                                          │
│                                                                             │
│   허용 규칙:                                                                │
│   - 테넌트 데이터 영역 → 품질 게이트: 443 (데이터 업로드, API 호출)        │
│   - 품질 게이트 → AI 내부망: gRPC (검증된 데이터 전달)                     │
│   - AI 내부망 → 품질 게이트: 443 (추론 결과 반환)                          │
│                                                                             │
│   거부 규칙 (핵심):                                                         │
│   ✗ 테넌트 → AI 내부망: 직접 접근 불가                                     │
│   ✗ 테넌트 → 공용 DB망: 직접 접근 불가                                     │
│   ✗ 테넌트 → AI 스토리지망: 직접 접근 불가                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 AI 플랫폼 계층 간 통신 정책

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     AI 플랫폼 4계층 통신 정책                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  1계층: 테넌트 데이터 영역 (VLAN 20, 21, 22)                        │  │
│   │  - 데이터 업로드용 최소 VM (선택) 또는 API 접근만                    │  │
│   │  - ※ 웹/앱/DB 서버 없음 (AI 서비스 이용자)                          │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                           │                                                 │
│                           │ 443 (HTTPS)                                     │
│                           ▼                                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  2계층: 데이터 품질 게이트 (VLAN 55 - AI 서비스망)                  │  │
│   │  - 데이터 검증, 민감정보 마스킹, 접근 제어                          │  │
│   │  - 테넌트 → AI 플랫폼 데이터 흐름 유일 경로                         │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                           │                                                 │
│                           │ gRPC (50051)                                    │
│                           ▼                                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  3계층: 공용 AI 플랫폼 (VLAN 50 - AI 내부망)                        │  │
│   │  - GPU 클러스터 (학습/추론)                                         │  │
│   │  - AI 모델 서버                                                     │  │
│   │  - 테넌트 직접 접근 불가                                            │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                           │                                                 │
│                           │ NFS/S3 (2049, 9000)                             │
│                           ▼                                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  4계층: AI 스토리지 (VLAN 60 - AI 스토리지망)                       │  │
│   │  - 모델 레지스트리                                                   │  │
│   │  - 데이터셋 저장소                                                   │  │
│   │  - 체크포인트/아티팩트                                               │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   계층 간 통신 매트릭스:                                                    │
│   ┌──────────────────┬─────────┬─────────┬─────────┬─────────┐            │
│   │ 출발 \ 목적지    │ 1계층   │ 2계층   │ 3계층   │ 4계층   │            │
│   ├──────────────────┼─────────┼─────────┼─────────┼─────────┤            │
│   │ 1계층 (테넌트)   │ 차단*   │ 허용    │ 차단    │ 차단    │            │
│   │ 2계층 (게이트)   │ 응답만  │ -       │ 허용    │ 차단    │            │
│   │ 3계층 (AI 내부)  │ 차단    │ 허용    │ 허용    │ 허용    │            │
│   │ 4계층 (AI 저장)  │ 차단    │ 차단    │ 허용    │ -       │            │
│   └──────────────────┴─────────┴─────────┴─────────┴─────────┘            │
│   * 동일 테넌트 내 허용                                                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 방화벽 정책

### 4.1 계층별 접근 제어 규칙

#### 4.1.1 DMZ 방화벽 규칙

| 규칙 ID | 출발지 | 목적지 | 포트 | 프로토콜 | 동작 |
|---------|--------|--------|------|---------|------|
| **DMZ-001** | ANY | DMZ LB | 443 | TCP | 허용 |
| **DMZ-002** | DMZ LB | 테넌트 업무망 | 8080 | TCP | 허용 |
| **DMZ-003** | DMZ LB | AI 서비스망 | 443 | TCP | 허용 |
| **DMZ-004** | 관리망 | DMZ | 22 | TCP | 허용 |
| **DMZ-999** | ANY | DMZ | ANY | ANY | **거부** |

#### 4.1.2 테넌트 데이터 영역 방화벽 규칙

| 규칙 ID | 출발지 | 목적지 | 포트 | 프로토콜 | 동작 |
|---------|--------|--------|------|---------|------|
| **TNT-001** | 테넌트 A | AI 서비스망 (품질게이트) | 443 | TCP | 허용 |
| **TNT-002** | 테넌트 B | AI 서비스망 (품질게이트) | 443 | TCP | 허용 |
| **TNT-003** | 테넌트 C | AI 서비스망 (품질게이트) | 443 | TCP | 허용 |
| **TNT-004** | 관리망 | 테넌트 데이터 영역 | 22 | TCP | 허용 |
| **TNT-005** | 테넌트 A | 테넌트 B | ANY | ANY | **거부** |
| **TNT-006** | 테넌트 A | 테넌트 C | ANY | ANY | **거부** |
| **TNT-007** | 테넌트 B | 테넌트 C | ANY | ANY | **거부** |
| **TNT-008** | 테넌트 ANY | 공용 DB망 | ANY | ANY | **거부** |
| **TNT-009** | 테넌트 ANY | AI 내부망 | ANY | ANY | **거부** |
| **TNT-010** | 테넌트 ANY | AI 스토리지망 | ANY | ANY | **거부** |
| **TNT-999** | ANY | 테넌트 데이터 영역 | ANY | ANY | **거부** |

> **참고**: 테넌트는 AI 서비스망(품질 게이트)을 통해서만 AI 플랫폼에 접근 가능

#### 4.1.3 공용 DB망 방화벽 규칙

| 규칙 ID | 출발지 | 목적지 | 포트 | 프로토콜 | 동작 |
|---------|--------|--------|------|---------|------|
| **DB-001** | AI 서비스망 | 공용 DB망 | 5432 | TCP | 허용 |
| **DB-002** | AI 내부망 | 공용 DB망 | 5432 | TCP | 허용 |
| **DB-003** | AI 서비스망 | 공용 DB망 | 6379 | TCP | 허용 |
| **DB-004** | AI 내부망 | 공용 DB망 | 5432 | TCP | 허용 |
| **DB-005** | 관리망 | 공용 DB망 | 22 | TCP | 허용 |
| **DB-999** | ANY | 공용 DB망 | ANY | ANY | **거부** |

#### 4.1.4 AI 플랫폼 방화벽 규칙

| 규칙 ID | 출발지 | 목적지 | 포트 | 프로토콜 | 동작 |
|---------|--------|--------|------|---------|------|
| **AI-001** | 테넌트 업무망 | AI 서비스망 | 443 | TCP | 허용 |
| **AI-002** | DMZ | AI 서비스망 | 443 | TCP | 허용 |
| **AI-003** | AI 서비스망 | AI 내부망 | 50051 | TCP | 허용 (gRPC) |
| **AI-004** | AI 서비스망 | AI 내부망 | 8080 | TCP | 허용 (Model Serving) |
| **AI-005** | AI 내부망 | AI 스토리지망 | 2049 | TCP | 허용 (NFS) |
| **AI-006** | AI 내부망 | AI 스토리지망 | 9000 | TCP | 허용 (S3/MinIO) |
| **AI-007** | AI 내부망 | AI 내부망 | 22,6443 | TCP | 허용 (SSH, K8s API) |
| **AI-008** | AI 내부망 | AI 내부망 | 2379-2380 | TCP | 허용 (etcd) |
| **AI-009** | 관리망 | AI 서비스망 | 22 | TCP | 허용 |
| **AI-010** | 관리망 | AI 내부망 | 22 | TCP | 허용 |
| **AI-011** | 테넌트 ANY | AI 내부망 | ANY | ANY | **거부** |
| **AI-012** | 테넌트 ANY | AI 스토리지망 | ANY | ANY | **거부** |
| **AI-999** | ANY | AI 플랫폼 | ANY | ANY | **거부** |

### 4.2 Security Group 설계

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     Security Group 구성                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   SG-DATA-UPLOAD (테넌트 데이터 업로드 VM용) - 선택적                       │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 22/tcp from SG-BASTION                                           │  │
│   │  - 22/tcp from 테넌트 관리자 IP (데이터 업로드용)                   │  │
│   │  Outbound:                                                          │  │
│   │  - 443/tcp to SG-AI-GATEWAY (품질 게이트)                           │  │
│   │  - 9100/tcp to SG-MONITOR (메트릭)                                  │  │
│   │  ※ 테넌트 웹/앱/DB 서버 없음                                        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   SG-QUALITY-GATE (품질 게이트용)                                          │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 443/tcp from SG-DATA-UPLOAD (테넌트 데이터 업로드)               │  │
│   │  - 443/tcp from 테넌트 VLAN (API 호출)                              │  │
│   │  - 22/tcp from SG-BASTION                                           │  │
│   │  Outbound:                                                          │  │
│   │  - 50051/tcp to SG-AI-INTERNAL (gRPC)                               │  │
│   │  - 5432/tcp to SG-DB (메타데이터)                                   │  │
│   │  - 9100/tcp to SG-MONITOR                                           │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   SG-DB (공용 메타데이터 DB용)                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 5432/tcp from SG-AI-INTERNAL (AI 서버)                           │  │
│   │  - 5432/tcp from SG-QUALITY-GATE (품질 게이트)                      │  │
│   │  - 6379/tcp from SG-AI-GATEWAY (Redis)                              │  │
│   │  - 22/tcp from SG-BASTION                                           │  │
│   │  Outbound:                                                          │  │
│   │  - 9100/tcp to SG-MONITOR                                           │  │
│   │  ※ 테넌트 직접 접근 불가                                            │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   SG-AI-GATEWAY (AI 품질 게이트/API Gateway용)                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 443/tcp from SG-APP (테넌트 API 호출)                            │  │
│   │  - 443/tcp from SG-LB (외부 API)                                    │  │
│   │  - 22/tcp from SG-BASTION                                           │  │
│   │  Outbound:                                                          │  │
│   │  - 50051/tcp to SG-AI-INTERNAL (gRPC)                               │  │
│   │  - 8080/tcp to SG-AI-INTERNAL (Model Serving)                       │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   SG-AI-INTERNAL (AI 내부망용)                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 50051/tcp from SG-AI-GATEWAY (gRPC)                              │  │
│   │  - 8080/tcp from SG-AI-GATEWAY (Model Serving)                      │  │
│   │  - 22/tcp from SG-BASTION                                           │  │
│   │  - 6443/tcp from SG-AI-INTERNAL (K8s API)                           │  │
│   │  - 2379-2380/tcp from SG-AI-INTERNAL (etcd)                         │  │
│   │  Outbound:                                                          │  │
│   │  - 2049/tcp to SG-AI-STORAGE (NFS)                                  │  │
│   │  - 9000/tcp to SG-AI-STORAGE (S3)                                   │  │
│   │  - 5432/tcp to SG-DB (메타데이터 DB)                                │  │
│   │  - ALL to SG-AI-INTERNAL (클러스터 내부 통신)                       │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   SG-AI-STORAGE (AI 스토리지용)                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 2049/tcp from SG-AI-INTERNAL (NFS)                               │  │
│   │  - 9000/tcp from SG-AI-INTERNAL (S3/MinIO)                          │  │
│   │  - 22/tcp from SG-BASTION                                           │  │
│   │  Outbound:                                                          │  │
│   │  - 9100/tcp to SG-MONITOR                                           │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   SG-BASTION (Bastion Host용)                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Inbound:                                                           │  │
│   │  - 22/tcp from 관리자 IP (Whitelist)                                │  │
│   │  Outbound:                                                          │  │
│   │  - 22/tcp to ALL (내부망)                                           │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 로드밸런서 설계

### 5.1 로드밸런서 구성

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     로드밸런서 구성                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [인터넷]                                                                  │
│       │                                                                     │
│       ▼                                                                     │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                    L7 Load Balancer (HAProxy)                       │  │
│   │                                                                     │  │
│   │   VIP: 10.0.1.10                                                    │  │
│   │   Public IP: xxx.xxx.xxx.xxx                                        │  │
│   │                                                                     │  │
│   │   URL Routing (AI 플랫폼 전용):                                    │  │
│   │   - /api/v1/classify  → AI 추론 API (민원 분류)                    │  │
│   │   - /api/v1/upload    → 데이터 업로드 API                          │  │
│   │   - /api/v1/status    → 서비스 상태 조회                           │  │
│   │   - /api/v1/quota     → 테넌트 쿼터 조회                           │  │
│   │   ※ 테넌트 웹/앱 라우팅 없음 (AI API만 제공)                       │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│           │                │                │                │             │
│           ▼                ▼                ▼                              │
│     ┌──────────┐    ┌──────────┐    ┌──────────┐                         │
│     │ 품질     │    │ AI 추론  │    │ AI 학습  │                         │
│     │ 게이트   │    │ 서버 풀  │    │ 서버 풀  │                         │
│     │ Pool     │    │ (GPU)    │    │ (GPU)    │                         │
│     └──────────┘    └──────────┘    └──────────┘                         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 5.2 로드밸런서 설정

| 항목 | 설정 값 |
|------|--------|
| **알고리즘** | Round Robin (기본), Least Connections (AI API) |
| **Health Check** | HTTP /health, 10초 간격, 3회 실패 시 제외 |
| **Session Persistence** | 없음 (Stateless), AI API는 IP Hash |
| **SSL Termination** | LB에서 TLS 1.3 종료 |
| **Connection Timeout** | 연결 30초, 읽기 60초, AI API는 300초 |
| **Rate Limiting** | 테넌트별 1000 req/min, AI API 100 req/min |

### 5.3 AI API Gateway 로드밸런싱

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     AI API 로드밸런싱                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [테넌트 데이터 영역 / 외부 API 호출]                                     │
│           │                                                                 │
│           │ /api/ai/v1/predict                                             │
│           ▼                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                    AI API Gateway (L7)                              │  │
│   │                                                                     │  │
│   │   VIP: 10.0.55.10                                                   │  │
│   │                                                                     │  │
│   │   Endpoint Routing:                                                 │  │
│   │   - /v1/predict   → 추론 서버 풀 (Least Connections)               │  │
│   │   - /v1/train     → 학습 서버 풀 (IP Hash)                         │  │
│   │   - /v1/models    → 모델 레지스트리 풀                              │  │
│   │   - /v1/status    → 상태 조회 (Round Robin)                        │  │
│   │                                                                     │  │
│   │   Rate Limiting (테넌트별):                                        │  │
│   │   - /v1/predict: 100 req/min                                       │  │
│   │   - /v1/train: 10 req/hour                                         │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                    │                │                │                     │
│                    ▼                ▼                ▼                     │
│              ┌──────────┐    ┌──────────┐    ┌──────────┐                 │
│              │ 추론     │    │ 학습     │    │ 모델     │                 │
│              │ 서버 풀  │    │ 서버 풀  │    │레지스트리│                 │
│              │ (GPU)    │    │ (GPU)    │    │          │                 │
│              └──────────┘    └──────────┘    └──────────┘                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. 데이터 품질 게이트 설계

### 6.1 품질 게이트 개요

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     데이터 품질 게이트 아키텍처                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  테넌트 환경 (VLAN 20, 21, 22)                                      │  │
│   │  - 테넌트 A (수원시): 민원 데이터 업로드                             │  │
│   │  - 테넌트 B (성남시): 민원 데이터 업로드                             │  │
│   │  - 테넌트 C (용인시): API 호출만                                     │  │
│   │  ※ 테넌트 웹/앱/DB 없음                                             │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                           │                                                 │
│                           │ HTTPS (443)                                     │
│                           ▼                                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │              ┌─────────────────────────────────────────┐            │  │
│   │              │      데이터 품질 게이트                  │            │  │
│   │              │      (Data Quality Gate)                │            │  │
│   │              └─────────────────────────────────────────┘            │  │
│   │                                                                     │  │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐             │  │
│   │   │   인증/인가  │→│  데이터 검증  │→│  민감정보    │             │  │
│   │   │   (AuthN/Z)  │  │  (Validation)│  │  마스킹      │             │  │
│   │   └──────────────┘  └──────────────┘  └──────────────┘             │  │
│   │          │                  │                  │                    │  │
│   │          ▼                  ▼                  ▼                    │  │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐             │  │
│   │   │  테넌트 할당 │→│  품질 점수   │→│  감사 로그   │             │  │
│   │   │  확인        │  │  평가        │  │  기록        │             │  │
│   │   └──────────────┘  └──────────────┘  └──────────────┘             │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                           │                                                 │
│                           │ gRPC (50051)                                    │
│                           ▼                                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  AI 내부망 (VLAN 50)                                                │  │
│   │  - 검증된 데이터만 전달                                              │  │
│   │  - 테넌트 식별 정보 유지 (멀티테넌시)                               │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 6.2 품질 게이트 기능 상세

| 기능 | 설명 | 처리 방식 |
|------|------|----------|
| **인증/인가** | 테넌트별 API 키 검증, RBAC 권한 확인 | JWT 토큰, API Key |
| **테넌트 할당 확인** | GPU 리소스 할당량 확인 | Redis 기반 쿼터 체크 |
| **데이터 검증** | 스키마 검증, 데이터 타입 확인 | JSON Schema, Pydantic |
| **품질 점수 평가** | 데이터 완전성, 일관성 평가 | 자체 스코어링 알고리즘 |
| **민감정보 마스킹** | 개인정보 자동 탐지 및 마스킹 | 정규식 + ML 모델 |
| **감사 로그 기록** | 모든 요청/응답 로깅 | ELK Stack 연동 |

### 6.3 민감정보 마스킹 정책

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     민감정보 마스킹 정책                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   분류 체계:                                                                │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  등급 1 (완전 마스킹)                                               │  │
│   │  - 주민등록번호: 123456-******* → 완전 제거 또는 토큰화             │  │
│   │  - 계좌번호: 전체 마스킹                                            │  │
│   │  - 비밀번호: 완전 제거                                              │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  등급 2 (부분 마스킹)                                               │  │
│   │  - 전화번호: 010-****-1234                                          │  │
│   │  - 이메일: a***@example.com                                         │  │
│   │  - 이름: 홍*동                                                      │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  등급 3 (일반화)                                                    │  │
│   │  - 생년월일: 1990년대생                                             │  │
│   │  - 주소: 서울시 강남구 (상세주소 제거)                              │  │
│   │  - 연령: 30대                                                       │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   처리 흐름:                                                                │
│   [원본 데이터] → [패턴 탐지] → [분류] → [마스킹 적용] → [검증된 데이터]  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 6.4 품질 게이트 API 명세

```yaml
# 품질 게이트 API 명세
openapi: 3.0.0
info:
  title: Data Quality Gate API
  version: 1.0.0

paths:
  /v1/validate:
    post:
      summary: 데이터 검증 및 마스킹
      parameters:
        - name: X-Tenant-ID
          in: header
          required: true
          schema:
            type: string
        - name: X-API-Key
          in: header
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  type: object
                masking_level:
                  type: string
                  enum: [strict, moderate, minimal]
      responses:
        200:
          description: 검증 완료
          content:
            application/json:
              schema:
                type: object
                properties:
                  validated_data:
                    type: object
                  quality_score:
                    type: number
                  masked_fields:
                    type: array
        400:
          description: 검증 실패
        403:
          description: 권한 없음
        429:
          description: 할당량 초과

  /v1/quota:
    get:
      summary: 테넌트 할당량 조회
      parameters:
        - name: X-Tenant-ID
          in: header
          required: true
      responses:
        200:
          description: 할당량 정보
          content:
            application/json:
              schema:
                type: object
                properties:
                  gpu_quota:
                    type: object
                  api_calls_remaining:
                    type: integer
                  storage_used:
                    type: string
```

### 6.5 품질 게이트 배포 구성

| 구성 요소 | 인스턴스 | 리소스 | 위치 |
|----------|---------|--------|------|
| **Gateway Pod** | 3 (Active-Active) | 4 vCPU, 8GB RAM | VLAN 55 |
| **Redis (캐시/세션)** | 3 (Cluster) | 2 vCPU, 4GB RAM | VLAN 55 |
| **PostgreSQL (메타데이터)** | 2 (Primary-Replica) | 4 vCPU, 16GB RAM | VLAN 30 |
| **Kafka (이벤트)** | 3 (Cluster) | 4 vCPU, 8GB RAM | VLAN 55 |

---

## 7. Zero Trust 아키텍처

### 7.1 인증/인가 체계

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     Zero Trust 인증 흐름                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [사용자/서비스]                                                           │
│         │                                                                   │
│         │ 1. 인증 요청                                                      │
│         ▼                                                                   │
│   ┌─────────────────┐                                                      │
│   │   인증 서버     │   - ID/Password 검증                                  │
│   │   (Keycloak)    │   - MFA (관리자)                                      │
│   │                 │   - SSO (SAML/OIDC)                                   │
│   └────────┬────────┘                                                      │
│            │ 2. JWT 토큰 발급                                               │
│            ▼                                                                │
│   ┌─────────────────┐                                                      │
│   │   API Gateway   │   - 토큰 검증                                         │
│   │                 │   - 권한 확인 (RBAC)                                  │
│   │                 │   - 테넌트 컨텍스트 주입                              │
│   └────────┬────────┘                                                      │
│            │ 3. 접근 허용                                                   │
│            ▼                                                                │
│   ┌─────────────────┐                                                      │
│   │   리소스 접근   │   - 리소스 레벨 권한 재검증                           │
│   │                 │   - 감사 로그 기록                                    │
│   └─────────────────┘                                                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 7.2 RBAC 역할 정의

| 역할 | 권한 | 대상 리소스 |
|------|------|-----------|
| **platform-admin** | 전체 관리 | 모든 리소스, 모든 테넌트 |
| **tenant-admin-a** | 테넌트 A 관리 | 테넌트 A 리소스, AI 서비스(A 할당분) |
| **tenant-admin-b** | 테넌트 B 관리 | 테넌트 B 리소스, AI 서비스(B 할당분) |
| **tenant-admin-c** | 테넌트 C 관리 | 테넌트 C 리소스, AI 서비스(C 할당분) |
| **tenant-user** | 리소스 사용 (읽기/실행) | 할당된 리소스 |
| **ai-operator** | AI 플랫폼 운영 | AI 내부망 리소스, 모델 관리 |
| **auditor** | 로그 조회 (읽기 전용) | 감사 로그, 보안 이벤트 |

### 7.3 권한 매트릭스

| 역할 | VM 관리 | 네트워크 설정 | AI API 사용 | GPU 할당 | 로그 조회 |
|------|--------|-------------|-----------|---------|----------|
| platform-admin | O | O | O | O | O |
| tenant-admin | O (자기 테넌트) | X | O (할당량 내) | X | O (자기 테넌트) |
| tenant-user | X | X | O (할당량 내) | X | X |
| ai-operator | X | X | O | O | O (AI 관련) |
| auditor | X | X | X | X | O |

---

## 8. 암호화 체계

### 8.1 전송 구간 암호화 (TLS)

| 구간 | 프로토콜 | 설정 |
|------|---------|------|
| **외부 → LB** | TLS 1.3 | 인증서 적용, HSTS |
| **LB → 웹서버** | TLS 1.2+ | 내부 인증서 |
| **테넌트 → AI Gateway** | TLS 1.3 | mTLS 지원 |
| **AI Gateway → AI 내부망** | TLS 1.2+ | 내부 인증서 |
| **AI 내부망 → AI 스토리지** | TLS 1.2+ | 내부 인증서 |
| **관리 접속** | SSH | 키 기반 인증 |

### 8.2 저장 데이터 암호화

| 대상 | 암호화 방식 | 키 관리 |
|------|-----------|--------|
| **공용 스토리지 (Ceph)** | AES-256-XTS | Ceph 자체 암호화, Vault 연동 |
| **AI 모델 스토리지** | AES-256-GCM | HashiCorp Vault |
| **DB 데이터** | TDE (AES-256) | DB 자체 관리, Vault 연동 |
| **백업 데이터** | AES-256 | 별도 키 관리, 키 로테이션 |
| **민감 데이터 (마스킹 전)** | AES-256-GCM | 테넌트별 키 분리 |

### 8.3 인증서 관리

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     인증서 구조                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [Root CA] (오프라인 보관)                                                 │
│       │                                                                     │
│       ├── [Intermediate CA - External]                                      │
│       │       │                                                             │
│       │       └── 외부 서비스 인증서 (LB, API Gateway)                      │
│       │                                                                     │
│       ├── [Intermediate CA - Internal]                                      │
│       │       │                                                             │
│       │       ├── 내부 서비스 인증서 (서비스 간)                            │
│       │       └── AI 플랫폼 인증서 (AI 서비스망, 내부망)                    │
│       │                                                                     │
│       └── [Intermediate CA - Management]                                    │
│               └── SSH 키, 관리 인증서, Bastion                              │
│                                                                             │
│   인증서 유효기간:                                                          │
│   - 외부 서비스: 1년 (자동 갱신, Let's Encrypt 또는 상용)                   │
│   - 내부 서비스: 2년 (cert-manager 자동 갱신)                               │
│   - CA: 10년                                                                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 9. 감사 및 로깅

### 9.1 로깅 대상

| 로그 유형 | 수집 대상 | 보관 기간 |
|----------|----------|----------|
| **인증 로그** | 로그인 성공/실패, 토큰 발급 | 1년 |
| **접근 로그** | API 호출, 리소스 접근 | 90일 |
| **변경 로그** | 리소스 생성/수정/삭제 | 1년 |
| **보안 로그** | 방화벽 차단, 권한 오류 | 1년 |
| **AI 요청 로그** | AI API 호출, 모델 추론 | 90일 |
| **품질 게이트 로그** | 데이터 검증, 마스킹 이벤트 | 1년 |
| **시스템 로그** | OS, 서비스 로그 | 30일 |

### 9.2 로그 형식

```json
{
  "timestamp": "2026-01-30T10:30:00Z",
  "log_type": "ai_request",
  "tenant_id": "tenant-a",
  "user": "admin-a@tenant-a",
  "source_ip": "10.0.20.10",
  "action": "ai.predict",
  "resource": "model/text-classifier-v1",
  "request_id": "req-uuid-1234",
  "quality_score": 0.95,
  "masked_fields": ["phone", "email"],
  "latency_ms": 150,
  "result": "success",
  "gpu_usage": {
    "profile": "PROF-4Q",
    "duration_sec": 2.5
  }
}
```

### 9.3 로그 수집 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     로그 수집 아키텍처                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   [각 서비스/VM]                                                            │
│        │                                                                    │
│        │ Filebeat/Fluentd                                                   │
│        ▼                                                                    │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                    Kafka Cluster                                    │  │
│   │                    (로그 버퍼링)                                    │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│        │                                                                    │
│        ├─────────────────┬─────────────────┐                               │
│        ▼                 ▼                 ▼                               │
│   ┌──────────┐     ┌──────────┐     ┌──────────┐                          │
│   │Logstash  │     │ 실시간   │     │ 장기     │                          │
│   │(파싱)    │     │ 분석     │     │ 저장     │                          │
│   └────┬─────┘     │(Flink)   │     │(S3/Ceph) │                          │
│        │           └──────────┘     └──────────┘                          │
│        ▼                                                                    │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                    Elasticsearch Cluster                            │  │
│   │                    (검색/분석용)                                    │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│        │                                                                    │
│        ▼                                                                    │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                    Kibana / Grafana                                 │  │
│   │                    (시각화/대시보드)                                │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 9.4 알림 정책

| 이벤트 | 심각도 | 조건 | 알림 방법 |
|--------|--------|------|----------|
| 인증 실패 연속 5회 | Critical | 동일 계정/IP | 즉시 알림 (SMS, Slack) |
| 권한 밖 접근 시도 | High | 권한 없는 리소스 접근 | 즉시 알림 |
| AI API 할당량 90% 도달 | Medium | 테넌트별 | 10분 내 알림 |
| 방화벽 차단 급증 | Medium | 1분간 100건 이상 | 10분 내 알림 |
| 품질 게이트 거부율 증가 | Medium | 10% 이상 증가 | 30분 내 알림 |
| 비정상 트래픽 패턴 | High | ML 기반 이상 탐지 | 즉시 알림 |
| SSL 인증서 만료 임박 | Medium | 30일 이내 만료 | 일일 알림 |

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-01-30 | 초안 작성 | - |
| 2.0 | 2026-02-02 | AI 플랫폼 네트워크 추가: AI 내부망, 서비스망, 품질 게이트 설계 | - |
| 3.0 | 2026-02-04 | **AI 플랫폼 중심 재구성**: 테넌트 업무망→데이터 영역으로 변경, 웹/앱/DB 방화벽 규칙 제거, 품질 게이트 중심 통신 정책 | - |

---

## 관련 문서

- [01_프로젝트_개요서.md](01_프로젝트_개요서.md)
- [02_팀_역할분담.md](02_팀_역할분담.md)
- [03_상세설계_가이드.md](03_상세설계_가이드.md)
- [04_컴퓨트_설계서.md](04_컴퓨트_설계서.md)
- [06_스토리지_설계서.md](06_스토리지_설계서.md)
