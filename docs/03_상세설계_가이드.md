# 상세설계 가이드

## 범정부 차세대 AI 공동 활용 인프라 구축 프로젝트
### 공공 데이터 주권 확보를 위한 멀티테넌트 프라이빗 클라우드 설계

| 항목 | 내용 |
|------|------|
| 문서명 | 상세설계 가이드 |
| 버전 | 2.0 |
| 작성일 | 2026-02-02 |
| 목적 | 각 팀이 상세 설계를 수행하기 전 알아야 할 배경지식 정리 |

---

**목차**

1. [설계 영향 요소 (Tier 1~4)](#1-설계-영향-요소-tier-14)
2. [에이블스택 플랫폼 이해](#2-에이블스택-플랫폼-이해)
3. [멀티테넌시 격리 원칙](#3-멀티테넌시-격리-원칙)
4. [GPU 가상화 기술](#4-gpu-가상화-기술)
5. [AI 워크로드 인프라](#5-ai-워크로드-인프라)
6. [Zero Trust 보안 모델](#6-zero-trust-보안-모델)
7. [IaC 가이드](#7-iac-가이드)
8. [참고 자료](#8-참고-자료)

---

## 1. 설계 영향 요소 (Tier 1~4)

본 프로젝트의 설계는 단순 자원 생성이 아닌, **계층화된 설계 영향 요소**를 체계적으로 고려한다.

### 1.1 Tier 구조 개요

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      설계 영향 요소 Tier 구조                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   Tier 1: 아키텍처 결정 (전체 구조에 영향)                                  │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  고가용성(HA) | 망분리 | DR/백업 | 멀티테넌시 | 컴플라이언스       │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   Tier 2: 데이터/처리 특성                                                  │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  트랜잭션 | 실시간 처리 | 대용량 데이터 | 수평 확장 | AI/ML 학습   │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   Tier 3: 보안/접근제어 (횡단 관심사)                                       │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  RBAC | 암호화 | 마이크로세그멘테이션 | Secrets | PKI | 품질게이트 │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   Tier 4: 레이어별 세부 (구현)                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  네트워크(SDN) | 컴퓨트(리소스풀+GPU) | 스토리지(SDS) | 운영(IaC)  │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 Tier 1: 아키텍처 결정

전체 시스템 구조에 영향을 미치는 최상위 결정 사항.

| 요소 | 설명 | 설계 시 고려 사항 |
|------|------|------------------|
| **고가용성(HA)** | 장애 시에도 서비스 지속 | SPOF 제거, 이중화, 자동 복구 |
| **망분리** | 네트워크 계층 분리 | DMZ/업무망/DB망/AI망, VLAN 설계 |
| **DR/백업** | 재해 복구 및 데이터 보호 | RPO/RTO 정의, 복제 전략 |
| **멀티테넌시** | 다수 테넌트 격리 운영 | 네트워크/스토리지/컴퓨트/GPU 격리 |
| **컴플라이언스** | 규정 준수 | 감사 로그, 접근 통제 |

### 1.3 Tier 2: 데이터/처리 특성

워크로드 특성에 따른 설계 결정.

| 요소 | 설명 | 영향 받는 설계 |
|------|------|--------------|
| **트랜잭션** | 데이터 무결성 보장 | DB 복제, 동기화 |
| **실시간 처리** | 저지연 요구 | 네트워크 QoS, 캐시 |
| **대용량 데이터** | 대량 저장/처리 | 스토리지 티어링 |
| **수평 확장** | 스케일아웃 필요 | 클러스터 설계 |
| **AI/ML 학습** | GPU 컴퓨팅, 대용량 I/O | GPU 풀, 고속 스토리지 |

### 1.4 Tier 3: 보안/접근제어

모든 계층에 적용되는 횡단 관심사.

| 요소 | 설명 | 적용 범위 |
|------|------|----------|
| **RBAC** | 역할 기반 접근 제어 | 전체 시스템 |
| **암호화** | 전송/저장 데이터 암호화 | 네트워크, 스토리지 |
| **마이크로세그멘테이션** | 워크로드 단위 네트워크 분리 | 네트워크 |
| **Secrets** | 비밀정보 관리 | 애플리케이션, 운영 |
| **PKI** | 인증서 기반 인증 | 인증/인가 |
| **품질 게이트** | 데이터 검증 및 익명화 | AI 플랫폼 |

### 1.5 Tier 4: 레이어별 세부

각 기술 레이어의 구체적인 구현 사항.

| 레이어 | 주요 기술 | 세부 항목 |
|--------|----------|----------|
| **네트워크** | SDN, OVS | L2/L3 설계, VLAN, LB, QoS |
| **컴퓨트** | KVM, 리소스풀, GPU | 하이퍼바이저, Migration, 쿼터, vGPU |
| **스토리지** | Ceph, SDS | 복제, 캐시, 스냅샷, 티어링 |
| **운영** | IaC, 모니터링 | Terraform, Ansible, Prometheus |

---

## 2. 에이블스택 플랫폼 이해

### 2.1 ABLESTACK 개요

| 항목 | 내용 |
|------|------|
| **플랫폼** | ABLESTACK HCI (Hyper-Converged Infrastructure) |
| **관리 도구** | Mold (CloudStack 기반) |
| **하이퍼바이저** | KVM |
| **스토리지** | Ceph (분산 스토리지) |
| **네트워크** | OVS (Open vSwitch) |

### 2.2 아키텍처 구성

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      ABLESTACK HCI 아키텍처                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                        Mold 관리 콘솔                                │  │
│   │   - 웹 기반 관리 UI                                                 │  │
│   │   - VM, 네트워크, 스토리지 관리                                     │  │
│   │   - 테넌트(Account/Domain) 관리                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                        HCI 노드 클러스터                             │  │
│   │                                                                     │  │
│   │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐              │  │
│   │   │   노드 1    │   │   노드 2    │   │   노드 3    │              │  │
│   │   │ ┌─────────┐ │   │ ┌─────────┐ │   │ ┌─────────┐ │              │  │
│   │   │ │   KVM   │ │   │ │   KVM   │ │   │ │   KVM   │ │              │  │
│   │   │ │ (VM 호스팅)│ │   │ │ (VM 호스팅)│ │   │ │ (VM 호스팅)│ │              │  │
│   │   │ └─────────┘ │   │ └─────────┘ │   │ └─────────┘ │              │  │
│   │   │ ┌─────────┐ │   │ ┌─────────┐ │   │ ┌─────────┐ │              │  │
│   │   │ │   OVS   │ │   │ │   OVS   │ │   │ │   OVS   │ │              │  │
│   │   │ │(네트워크) │ │   │ │(네트워크) │ │   │ │(네트워크) │ │              │  │
│   │   │ └─────────┘ │   │ └─────────┘ │   │ └─────────┘ │              │  │
│   │   │ ┌─────────┐ │   │ ┌─────────┐ │   │ ┌─────────┐ │              │  │
│   │   │ │  Ceph   │ │   │ │  Ceph   │ │   │ │  Ceph   │ │              │  │
│   │   │ │  (OSD)  │ │   │ │  (OSD)  │ │   │ │  (OSD)  │ │              │  │
│   │   │ └─────────┘ │   │ └─────────┘ │   │ └─────────┘ │              │  │
│   │   │ ┌─────────┐ │   │             │   │             │              │  │
│   │   │ │   GPU   │ │   │             │   │             │              │  │
│   │   │ │ (선택)  │ │   │             │   │             │              │  │
│   │   │ └─────────┘ │   │             │   │             │              │  │
│   │   └─────────────┘   └─────────────┘   └─────────────┘              │  │
│   │                                                                     │  │
│   │         ◄─────────── Ceph 복제 (데이터 분산) ───────────►          │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.3 Mold 관리 도구

Mold는 CloudStack 기반의 관리 플랫폼으로, 다음 기능을 제공한다:

| 기능 | 설명 |
|------|------|
| **인프라 관리** | Zone, Pod, Cluster, Host 관리 |
| **VM 관리** | 인스턴스 생성/삭제/시작/정지 |
| **네트워크 관리** | VLAN, VPC, Security Group |
| **스토리지 관리** | Primary/Secondary Storage, 볼륨 |
| **테넌트 관리** | Domain, Account, User, Project |
| **템플릿/ISO** | VM 템플릿, ISO 이미지 관리 |
| **GPU 관리** | vGPU 프로파일, GPU 호스트 관리 |

### 2.4 KVM 하이퍼바이저

| 항목 | 내용 |
|------|------|
| **역할** | VM 가상화 |
| **관리** | libvirt를 통한 VM 관리 |
| **기능** | Live Migration, Snapshot, 리소스 제한, GPU Passthrough |

**주요 개념:**
- **호스트(Host)**: VM을 실행하는 물리 서버
- **인스턴스(Instance)**: 실행 중인 VM
- **템플릿(Template)**: VM 생성을 위한 기본 이미지

### 2.5 Ceph 분산 스토리지

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Ceph 아키텍처                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                           Ceph 클러스터                              │  │
│   │                                                                     │  │
│   │   ┌─────────┐   ┌─────────┐   ┌─────────┐                          │  │
│   │   │   MON   │   │   MON   │   │   MON   │  ← Monitor (클러스터 상태)│  │
│   │   └─────────┘   └─────────┘   └─────────┘                          │  │
│   │                                                                     │  │
│   │   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐           │  │
│   │   │   OSD   │   │   OSD   │   │   OSD   │   │   OSD   │           │  │
│   │   │  (NVMe) │   │  (NVMe) │   │  (HDD)  │   │  (HDD)  │           │  │
│   │   │   Hot   │   │   Hot   │   │  Cold   │   │  Cold   │           │  │
│   │   └─────────┘   └─────────┘   └─────────┘   └─────────┘           │  │
│   │                                                                     │  │
│   │   데이터 복제: replica 3 (3중 복제)                                 │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   접근 방식:                                                                │
│   - RBD (Block): VM 디스크                                                 │
│   - CephFS (File): 공유 파일시스템                                         │
│   - RGW (Object): S3 호환 오브젝트 스토리지                                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

**주요 개념:**
- **MON (Monitor)**: 클러스터 상태 관리, Quorum 유지
- **OSD (Object Storage Daemon)**: 실제 데이터 저장
- **Pool**: 논리적 스토리지 그룹
- **CRUSH Map**: 데이터 배치 규칙

### 2.6 OVS (Open vSwitch)

| 항목 | 내용 |
|------|------|
| **역할** | 가상 네트워크 스위치 |
| **기능** | VLAN, VXLAN, 트래픽 제어 |
| **통합** | OpenFlow 지원, SDN 연동 |

---

## 3. 멀티테넌시 격리 원칙

### 3.1 격리의 4계층

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        멀티테넌시 격리 4계층                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Layer 1: 네트워크 격리                                              │  │
│   │  ────────────────────────────────────────────────────────────────   │  │
│   │  - 테넌트별 전용 VLAN 할당                                          │  │
│   │  - 마이크로세그멘테이션으로 East-West 트래픽 차단                   │  │
│   │  - 공용 서비스 접근은 API Gateway 경유만 허용                       │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Layer 2: 스토리지 격리                                              │  │
│   │  ────────────────────────────────────────────────────────────────   │  │
│   │  - 테넌트별 Ceph Pool 분리                                          │  │
│   │  - 쿼터 기반 용량 제한                                              │  │
│   │  - 스냅샷/백업 테넌트별 분리                                        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Layer 3: 컴퓨트 격리                                                │  │
│   │  ────────────────────────────────────────────────────────────────   │  │
│   │  - 테넌트별 리소스 쿼터 (vCPU, Memory)                              │  │
│   │  - 테넌트별 GPU 쿼터 (vGPU 수, GPU 메모리)                          │  │
│   │  - Affinity/Anti-Affinity 규칙                                      │  │
│   │  - 전용 호스트 옵션 (민감 워크로드용)                               │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Layer 4: 접근제어 격리                                              │  │
│   │  ────────────────────────────────────────────────────────────────   │  │
│   │  - RBAC: 플랫폼관리자 / 테넌트관리자 / 사용자                       │  │
│   │  - 테넌트 A 관리자는 테넌트 B 리소스 접근 불가                      │  │
│   │  - 감사 로그 테넌트별 분리                                          │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 격리 원칙

| 원칙 | 설명 | 적용 |
|------|------|------|
| **기본 차단** | 테넌트 간 통신은 기본 차단 | 네트워크 정책 |
| **명시적 허용** | 허용된 통신만 명시적으로 개방 | 방화벽 규칙 |
| **최소 권한** | 필요한 최소 권한만 부여 | RBAC |
| **감사 추적** | 모든 접근 기록 | 로깅 |

### 3.3 테넌트 구조 (Mold)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        Mold 테넌트 구조                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ROOT Domain (최상위)                                                      │
│   │                                                                         │
│   ├── Domain: TenantA (A시청)                                              │
│   │   ├── Account: admin-a (테넌트 관리자)                                 │
│   │   ├── Account: user-a1 (일반 사용자)                                   │
│   │   └── Account: user-a2 (일반 사용자)                                   │
│   │                                                                         │
│   ├── Domain: TenantB (B구청)                                              │
│   │   ├── Account: admin-b (테넌트 관리자)                                 │
│   │   └── Account: user-b1 (일반 사용자)                                   │
│   │                                                                         │
│   └── Domain: TenantC (C군청)                                              │
│       ├── Account: admin-c (테넌트 관리자)                                 │
│       └── Account: user-c1 (일반 사용자)                                   │
│                                                                             │
│   리소스 격리:                                                              │
│   - 각 Domain은 독립된 VLAN, 스토리지 Pool, 쿼터 할당                       │
│   - Domain 간 리소스 접근 불가                                              │
│   - GPU 쿼터도 Domain 단위로 할당                                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. GPU 가상화 기술

### 4.1 GPU 가상화 개요

멀티테넌트 환경에서 GPU를 효율적으로 공유하기 위해 다양한 가상화 기술을 활용한다.

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         GPU 가상화 방식 비교                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  1. GPU Passthrough (전용 할당)                                      │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │                                                                     │  │
│   │   ┌─────────┐          ┌─────────────────────┐                     │  │
│   │   │   VM    │◄────────►│    Physical GPU     │                     │  │
│   │   │         │   직접   │   (전체 GPU 독점)   │                     │  │
│   │   └─────────┘   연결   └─────────────────────┘                     │  │
│   │                                                                     │  │
│   │   특징: 최고 성능, 1:1 매핑, 학습용 권장                           │  │
│   │   단점: GPU 공유 불가, 비용 효율 낮음                              │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  2. vGPU (NVIDIA GRID)                                              │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │                                                                     │  │
│   │   ┌──────┐ ┌──────┐ ┌──────┐     ┌─────────────────────┐          │  │
│   │   │ VM 1 │ │ VM 2 │ │ VM 3 │     │    Physical GPU     │          │  │
│   │   │vGPU-A│ │vGPU-B│ │vGPU-C│     │  ┌─────┬─────┬─────┐│          │  │
│   │   └──┬───┘ └──┬───┘ └──┬───┘     │  │ A   │ B   │ C   ││          │  │
│   │      └────────┼────────┘          │  │8GB  │4GB  │4GB  ││          │  │
│   │               └──────────────────►│  └─────┴─────┴─────┘│          │  │
│   │                                   └─────────────────────┘          │  │
│   │                                                                     │  │
│   │   특징: 유연한 메모리 분할, 동적 할당, 라이선스 필요               │  │
│   │   권장: 추론, 개발/테스트, 다수 사용자 환경                         │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  3. MIG (Multi-Instance GPU) - A100/H100                            │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │                                                                     │  │
│   │   ┌──────┐ ┌──────┐ ┌──────┐     ┌─────────────────────┐          │  │
│   │   │ VM 1 │ │ VM 2 │ │ VM 3 │     │   A100 GPU (80GB)   │          │  │
│   │   │MIG-1g│ │MIG-2g│ │MIG-4g│     │  ┌────┬────┬────────┐│          │  │
│   │   └──┬───┘ └──┬───┘ └──┬───┘     │  │1g  │2g  │  4g    ││          │  │
│   │      └────────┼────────┘          │  │10GB│20GB│ 40GB   ││          │  │
│   │               └──────────────────►│  └────┴────┴────────┘│          │  │
│   │                                   └─────────────────────┘          │  │
│   │                                                                     │  │
│   │   특징: 하드웨어 수준 격리, 완전한 성능 보장, 보안 강화             │  │
│   │   제한: A100, H100 등 특정 GPU만 지원                              │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  4. Time-slicing (시간 분할)                                        │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │                                                                     │  │
│   │   ┌──────┐ ┌──────┐ ┌──────┐                                       │  │
│   │   │ VM 1 │ │ VM 2 │ │ VM 3 │                                       │  │
│   │   └──┬───┘ └──┬───┘ └──┬───┘                                       │  │
│   │      │        │        │        시간축 ──────────────────►          │  │
│   │      └────────┼────────┘        [VM1][VM2][VM3][VM1][VM2][VM3]...   │  │
│   │               │                                                     │  │
│   │               ▼                                                     │  │
│   │      ┌─────────────────────┐                                       │  │
│   │      │    Physical GPU     │                                       │  │
│   │      └─────────────────────┘                                       │  │
│   │                                                                     │  │
│   │   특징: 라이선스 불필요, 간단한 구성                               │  │
│   │   단점: 성능 예측 어려움, 메모리 경합 가능                          │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 GPU 가상화 방식 비교

| 방식 | 성능 | 격리 수준 | 유연성 | 비용 | 권장 용도 |
|------|------|----------|--------|------|----------|
| **Passthrough** | 100% | 완전 격리 | 낮음 | 높음 | 대규모 학습 |
| **vGPU (GRID)** | 90~95% | 높음 | 높음 | 중간 (라이선스) | 추론, 다중 사용자 |
| **MIG** | 95~100% | 완전 격리 | 중간 | 높음 | 혼합 워크로드 |
| **Time-slicing** | 가변 | 낮음 | 높음 | 낮음 | 개발/테스트 |

### 4.3 vGPU 프로파일

NVIDIA GRID vGPU는 프로파일 기반으로 GPU 메모리를 분할한다:

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      vGPU 프로파일 예시 (NVIDIA A10)                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   물리 GPU: NVIDIA A10 (24GB VRAM)                                          │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  프로파일명         │ VRAM  │ 최대 VM 수 │ 용도                     │  │
│   │  ────────────────────────────────────────────────────────────────   │  │
│   │  A10-1B             │  1GB  │    24      │ 가벼운 추론              │  │
│   │  A10-2B             │  2GB  │    12      │ 소형 모델 추론           │  │
│   │  A10-4Q             │  4GB  │     6      │ 중형 모델, 개발          │  │
│   │  A10-8Q             │  8GB  │     3      │ 대형 모델 추론           │  │
│   │  A10-12Q            │ 12GB  │     2      │ 파인튜닝, 중간 학습      │  │
│   │  A10-24Q            │ 24GB  │     1      │ 전체 GPU (학습용)        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   프로파일 선정 기준:                                                       │
│   - B (Basic): 그래픽 워크로드                                             │
│   - Q (Quadro): 전문 그래픽 및 컴퓨팅                                      │
│   - C (Compute): CUDA 컴퓨팅 전용                                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.4 GPU 스케줄링

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         GPU 스케줄링 아키텍처                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                        작업 큐 (Job Queue)                          │  │
│   │   ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐                  │  │
│   │   │ 학습-A  │ │ 학습-B  │ │ 추론-C  │ │ 학습-D  │ ...              │  │
│   │   │ P:High  │ │ P:Med   │ │ P:High  │ │ P:Low   │                  │  │
│   │   └─────────┘ └─────────┘ └─────────┘ └─────────┘                  │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                        스케줄러 (Scheduler)                         │  │
│   │   ────────────────────────────────────────────────────────────────  │  │
│   │   정책:                                                             │  │
│   │   - Fair-Share: 테넌트별 공정한 GPU 시간 배분                       │  │
│   │   - Priority: 우선순위 기반 스케줄링 (학습 > 추론)                  │  │
│   │   - Preemption: 높은 우선순위 작업을 위한 선점                     │  │
│   │   - Quota: 테넌트별 GPU 시간/메모리 쿼터                           │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                    │                                        │
│                                    ▼                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         GPU 풀 (GPU Pool)                           │  │
│   │   ┌─────────────────────┐   ┌─────────────────────┐                │  │
│   │   │    학습용 GPU 풀    │   │    추론용 GPU 풀    │                │  │
│   │   │  (Passthrough)      │   │  (vGPU 공유)        │                │  │
│   │   │  ┌─────┐ ┌─────┐   │   │  ┌─────┐ ┌─────┐   │                │  │
│   │   │  │GPU1 │ │GPU2 │   │   │  │GPU3 │ │GPU4 │   │                │  │
│   │   │  │전용 │ │전용 │   │   │  │vGPU │ │vGPU │   │                │  │
│   │   │  └─────┘ └─────┘   │   │  └─────┘ └─────┘   │                │  │
│   │   └─────────────────────┘   └─────────────────────┘                │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.5 GPU 할당 정책 설계 고려사항

| 고려 사항 | 설명 | 권장 설정 |
|----------|------|----------|
| **테넌트별 쿼터** | 각 테넌트가 사용할 수 있는 GPU 자원 제한 | vGPU 수, GPU 메모리, 동시 작업 수 |
| **우선순위** | 작업 유형별 우선순위 | 긴급 추론 > 일반 추론 > 학습 |
| **시간 제한** | 단일 작업 최대 실행 시간 | 학습: 24시간, 추론: 무제한 |
| **대기열 정책** | 대기 중인 작업 처리 방식 | FIFO with priority |
| **선점 정책** | 높은 우선순위 작업을 위한 선점 허용 | 체크포인트 후 선점 |

---

## 5. AI 워크로드 인프라

### 5.1 AI 워크로드 특성

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AI 워크로드 vs 일반 워크로드                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌───────────────────────────────┬───────────────────────────────┐        │
│   │        일반 워크로드          │        AI 워크로드             │        │
│   ├───────────────────────────────┼───────────────────────────────┤        │
│   │                               │                               │        │
│   │  • CPU 중심 연산              │  • GPU 중심 연산              │        │
│   │  • 중간 메모리 사용           │  • 대용량 메모리 (GPU VRAM)   │        │
│   │  • 낮은 I/O                   │  • 높은 I/O (학습 데이터)     │        │
│   │  • 균일한 부하                │  • 버스트성 부하              │        │
│   │  • 수평 확장 용이             │  • GPU 종속적 확장            │        │
│   │                               │                               │        │
│   │  예: 웹서버, DB, 앱서버       │  예: 모델 학습, 추론 서비스   │        │
│   │                               │                               │        │
│   └───────────────────────────────┴───────────────────────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 5.2 AI 학습 인프라

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AI 학습 인프라 구성                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         학습 클러스터                                │  │
│   │                                                                     │  │
│   │   ┌───────────────┐   ┌───────────────┐   ┌───────────────┐        │  │
│   │   │  학습 노드 1  │   │  학습 노드 2  │   │  학습 노드 3  │        │  │
│   │   │ ┌───────────┐ │   │ ┌───────────┐ │   │ ┌───────────┐ │        │  │
│   │   │ │ GPU x 4   │ │   │ │ GPU x 4   │ │   │ │ GPU x 4   │ │        │  │
│   │   │ │ (A100)    │ │   │ │ (A100)    │ │   │ │ (A100)    │ │        │  │
│   │   │ └───────────┘ │   │ └───────────┘ │   │ └───────────┘ │        │  │
│   │   │ RAM: 512GB    │   │ RAM: 512GB    │   │ RAM: 512GB    │        │  │
│   │   │ NVMe: 8TB     │   │ NVMe: 8TB     │   │ NVMe: 8TB     │        │  │
│   │   └───────────────┘   └───────────────┘   └───────────────┘        │  │
│   │           │                   │                   │                 │  │
│   │           └───────────────────┼───────────────────┘                 │  │
│   │                               │                                     │  │
│   │                    ┌──────────▼──────────┐                         │  │
│   │                    │   고속 네트워크      │                         │  │
│   │                    │  (100GbE / RDMA)    │                         │  │
│   │                    └──────────┬──────────┘                         │  │
│   │                               │                                     │  │
│   │                    ┌──────────▼──────────┐                         │  │
│   │                    │   분산 학습 지원    │                         │  │
│   │                    │  (NCCL, Horovod)   │                         │  │
│   │                    └─────────────────────┘                         │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                               │                                             │
│                    ┌──────────▼──────────┐                                 │
│                    │   학습 데이터 저장소 │                                 │
│                    │  (고속 Ceph Pool)   │                                 │
│                    │  NVMe SSD 기반      │                                 │
│                    └─────────────────────┘                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

**학습 인프라 요구사항:**

| 항목 | 요구사항 | 이유 |
|------|---------|------|
| **GPU** | 대용량 VRAM (40GB+) | 대형 모델 로드 |
| **메모리** | 대용량 RAM (256GB+) | 데이터 전처리, 배치 로딩 |
| **스토리지** | 고속 I/O (NVMe) | 데이터 로딩 병목 방지 |
| **네트워크** | 고대역폭 (25G+) | 분산 학습 통신 |
| **GPU 간 통신** | NVLink / NVSwitch | GPU 간 고속 데이터 전송 |

### 5.3 AI 추론 인프라

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AI 추론 인프라 구성                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                         추론 클러스터                                │  │
│   │                                                                     │  │
│   │   ┌───────────────┐   ┌───────────────┐   ┌───────────────┐        │  │
│   │   │  추론 노드 1  │   │  추론 노드 2  │   │  추론 노드 N  │        │  │
│   │   │ ┌───────────┐ │   │ ┌───────────┐ │   │ ┌───────────┐ │        │  │
│   │   │ │  vGPU x 4 │ │   │ │  vGPU x 4 │ │   │ │  vGPU x 4 │ │        │  │
│   │   │ │ (8GB each)│ │   │ │ (8GB each)│ │   │ │ (8GB each)│ │        │  │
│   │   │ └───────────┘ │   │ └───────────┘ │   │ └───────────┘ │        │  │
│   │   │ RAM: 64GB     │   │ RAM: 64GB     │   │ RAM: 64GB     │        │  │
│   │   └───────────────┘   └───────────────┘   └───────────────┘        │  │
│   │           │                   │                   │                 │  │
│   │           └───────────────────┼───────────────────┘                 │  │
│   │                               │                                     │  │
│   │                    ┌──────────▼──────────┐                         │  │
│   │                    │    로드밸런서       │                         │  │
│   │                    │  (L7 / Inference)  │                         │  │
│   │                    └──────────┬──────────┘                         │  │
│   │                               │                                     │  │
│   │                    ┌──────────▼──────────┐                         │  │
│   │                    │    API Gateway     │                         │  │
│   │                    │  (Rate Limiting)   │                         │  │
│   │                    └─────────────────────┘                         │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                               │                                             │
│                    ┌──────────▼──────────┐                                 │
│                    │   모델 저장소        │                                 │
│                    │  (Model Registry)  │                                 │
│                    └─────────────────────┘                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

**추론 인프라 요구사항:**

| 항목 | 요구사항 | 이유 |
|------|---------|------|
| **GPU** | 중간 VRAM (8~16GB) | 모델 로드 + 배치 처리 |
| **지연 시간** | 낮은 latency (<100ms) | 실시간 서비스 |
| **처리량** | 높은 throughput | 동시 요청 처리 |
| **가용성** | 고가용성 (HA) | 서비스 연속성 |
| **확장성** | 수평 확장 가능 | 트래픽 증가 대응 |

### 5.4 AI 스토리지 요구사항

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      AI 스토리지 티어 구조                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Hot Tier (NVMe SSD) - 고성능                                       │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │  • 활성 학습 데이터셋                                              │  │
│   │  • 현재 서빙 중인 모델                                             │  │
│   │  • 추론 서버 모델 캐시                                             │  │
│   │                                                                     │  │
│   │  I/O 요구: 읽기 3GB/s, 쓰기 2GB/s, IOPS 100K+                      │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                               │ 30일 미접근                                │
│                               ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Warm Tier (SATA SSD) - 중간                                        │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │  • 최근 체크포인트                                                  │  │
│   │  • 준비 중인 데이터셋                                               │  │
│   │  • 이전 버전 모델                                                   │  │
│   │                                                                     │  │
│   │  I/O 요구: 읽기 500MB/s, 쓰기 300MB/s, IOPS 10K                    │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                               │ 90일 미접근                                │
│                               ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │  Cold Tier (HDD) - 대용량                                           │  │
│   │  ─────────────────────────────────────────────────────────────────  │  │
│   │  • 오래된 체크포인트                                                │  │
│   │  • 아카이브 데이터셋                                                │  │
│   │  • 컴플라이언스 데이터                                              │  │
│   │                                                                     │  │
│   │  Erasure Coding 적용 (저장 효율)                                    │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. Zero Trust 보안 모델

### 6.1 Zero Trust 원칙

> **"신뢰하지 않고 항상 검증한다 (Never Trust, Always Verify)"**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        Zero Trust 아키텍처                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                       ┌─────────────────┐                                  │
│                       │    접근 요청    │                                  │
│                       └────────┬────────┘                                  │
│                                │                                            │
│                                ▼                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                     1. 신원 확인 (Who)                               │  │
│   │   - 사용자/서비스 인증                                               │  │
│   │   - MFA (관리자 필수)                                                │  │
│   │   - 인증서 기반 인증 (mTLS)                                          │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                │                                            │
│                                ▼                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                     2. 장치 검증 (What)                              │  │
│   │   - 장치 상태 확인                                                   │  │
│   │   - 보안 패치 상태                                                   │  │
│   │   - 네트워크 위치                                                    │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                │                                            │
│                                ▼                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                     3. 접근 권한 확인 (How)                          │  │
│   │   - RBAC 기반 권한 확인                                              │  │
│   │   - 최소 권한 원칙                                                   │  │
│   │   - 컨텍스트 기반 접근 제어                                          │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                │                                            │
│                                ▼                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                     4. 지속적 모니터링                               │  │
│   │   - 세션 검증                                                        │  │
│   │   - 이상 행위 탐지                                                   │  │
│   │   - 감사 로깅                                                        │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                │                                            │
│                                ▼                                            │
│                       ┌─────────────────┐                                  │
│                       │    접근 허용    │                                  │
│                       └─────────────────┘                                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 6.2 RBAC (Role-Based Access Control)

| 역할 | 권한 | 대상 |
|------|------|------|
| **플랫폼 관리자** | 전체 시스템 관리, 테넌트 생성/삭제 | 인프라 관리자 |
| **테넌트 관리자** | 자기 테넌트 내 리소스 관리, 사용자 관리 | 기관 담당자 |
| **일반 사용자** | 할당된 리소스 사용 (읽기/실행) | 기관 직원 |
| **감사자** | 로그 조회 (읽기 전용) | 보안 담당자 |

### 6.3 암호화 체계

| 구간 | 암호화 방식 | 적용 |
|------|-----------|------|
| **전송 중** | TLS 1.3 | 모든 네트워크 통신 |
| **저장 시** | AES-256 | 스토리지 데이터 |
| **키 관리** | Vault 등 KMS | 암호화 키 중앙 관리 |

---

## 7. IaC 가이드

### 7.1 IaC 도구

| 도구 | 용도 | 적용 범위 |
|------|------|----------|
| **Terraform** | 인프라 프로비저닝 | VM, 네트워크, 스토리지, GPU 할당 |
| **Ansible** | 구성 관리 | OS 설정, 패키지 설치, 앱 배포 |
| **Git** | 버전 관리 | 모든 IaC 코드 |

### 7.2 Terraform 구조

```
terraform/
├── modules/
│   ├── compute/              # VM 생성 모듈
│   │   ├── main.tf           # 리소스 정의
│   │   ├── variables.tf      # 입력 변수
│   │   └── outputs.tf        # 출력 변수
│   │
│   ├── gpu/                  # GPU 할당 모듈 [신규]
│   │   ├── vgpu.tf           # vGPU 프로파일
│   │   ├── passthrough.tf    # GPU Passthrough
│   │   └── quota.tf          # GPU 쿼터
│   │
│   ├── network/              # 네트워크 모듈
│   │   ├── vlan.tf           # VLAN 정의
│   │   ├── firewall.tf       # 방화벽 규칙
│   │   └── loadbalancer.tf   # 로드밸런서
│   │
│   ├── storage/              # 스토리지 모듈
│   │   ├── pool.tf           # 스토리지 풀
│   │   ├── ai_storage.tf     # AI 스토리지 [신규]
│   │   └── quota.tf          # 쿼터 설정
│   │
│   └── tenant/               # 테넌트 모듈
│       ├── main.tf           # 테넌트 프로비저닝
│       └── rbac.tf           # 권한 설정
│
├── environments/
│   ├── dev/                  # 개발 환경
│   │   ├── main.tf
│   │   └── terraform.tfvars
│   │
│   └── prod/                 # 운영 환경
│       ├── main.tf
│       └── terraform.tfvars
│
└── main.tf                   # 루트 모듈
```

### 7.3 Terraform 작성 원칙

| 원칙 | 설명 |
|------|------|
| **모듈화** | 재사용 가능한 모듈로 분리 |
| **상태 관리** | 원격 백엔드로 상태 파일 관리 |
| **변수화** | 하드코딩 대신 변수 사용 |
| **버전 관리** | 프로바이더/모듈 버전 명시 |

### 7.4 Ansible 구조

```
ansible/
├── inventory/
│   ├── dev.yml               # 개발 환경 인벤토리
│   └── prod.yml              # 운영 환경 인벤토리
│
├── playbooks/
│   ├── base-setup.yml        # 기본 OS 설정
│   ├── gpu-driver.yml        # GPU 드라이버 설치 [신규]
│   ├── cuda-toolkit.yml      # CUDA 설치 [신규]
│   ├── monitoring-agent.yml  # 모니터링 에이전트
│   ├── security-hardening.yml# 보안 강화
│   └── app-deploy.yml        # 애플리케이션 배포
│
├── roles/
│   ├── common/               # 공통 설정
│   ├── nvidia-driver/        # NVIDIA 드라이버 [신규]
│   ├── cuda/                 # CUDA Toolkit [신규]
│   ├── prometheus-exporter/  # Prometheus 에이전트
│   ├── dcgm-exporter/        # GPU 메트릭 수집 [신규]
│   ├── filebeat/             # 로그 수집
│   └── hardening/            # 보안 강화
│
└── ansible.cfg               # Ansible 설정
```

### 7.5 Ansible 작성 원칙

| 원칙 | 설명 |
|------|------|
| **멱등성** | 여러 번 실행해도 동일한 결과 |
| **역할 분리** | 기능별 Role로 분리 |
| **변수 우선순위** | inventory < playbook < role < task |
| **비밀정보 관리** | Ansible Vault 사용 |

---

## 8. 참고 자료

### 8.1 공식 문서

| 기술 | 문서 링크 |
|------|----------|
| **ABLESTACK** | 에이블스택 공식 문서 |
| **CloudStack** | https://docs.cloudstack.apache.org/ |
| **Ceph** | https://docs.ceph.com/ |
| **KVM** | https://www.linux-kvm.org/page/Documents |
| **Terraform** | https://developer.hashicorp.com/terraform/docs |
| **Ansible** | https://docs.ansible.com/ |
| **NVIDIA vGPU** | https://docs.nvidia.com/grid/ |
| **NVIDIA MIG** | https://docs.nvidia.com/datacenter/tesla/mig-user-guide/ |

### 8.2 학습 키워드

**컴퓨트 팀:**
```
KVM, libvirt, QEMU, vCPU, Memory overcommit
Resource Pool, Affinity, Anti-Affinity
Live Migration, HA, Fault Domain
Cloud-init, VM Template
NVIDIA vGPU, NVIDIA GRID
MIG (Multi-Instance GPU)
GPU Passthrough, PCIe
CUDA, cuDNN, NCCL
```

**네트워크/보안 팀:**
```
VLAN, VXLAN, OVS, SDN
Security Group, Firewall, iptables
Zero Trust, RBAC, ABAC
TLS, PKI, mTLS
마이크로세그멘테이션, East-West 트래픽
데이터 익명화, k-anonymity
PII 탐지, 품질 게이트
```

**스토리지 팀:**
```
Ceph, OSD, MON, CRUSH Map
Pool, Replication, Erasure Coding
Tiering, Hot/Warm/Cold
RBD, CephFS, RGW
Snapshot, Backup, DR
RPO, RTO
병렬 I/O, NVMe SSD
AI 학습 데이터 스토리지
모델 레지스트리
```

### 8.3 본 프로젝트 관련 문서

- [01_프로젝트_개요서.md](01_프로젝트_개요서.md)
- [02_팀_역할분담.md](02_팀_역할분담.md)
- [04_컴퓨트_설계서.md](04_컴퓨트_설계서.md)
- [05_네트워크_보안_설계서.md](05_네트워크_보안_설계서.md)
- [06_스토리지_설계서.md](06_스토리지_설계서.md)

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-01-30 | 초안 작성 | - |
| 2.0 | 2026-02-02 | **GPU/AI 배경지식 추가**: GPU 가상화 기술, AI 워크로드 인프라 섹션 신규 | - |
